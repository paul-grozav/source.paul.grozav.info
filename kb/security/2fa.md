---
layout: page
title: 2 Factor Authentication
---
The 2FA is a mechanism that generates a second password(known as TOTP), that is dynamic, for you to use along with the first password (static), when connecting to your account. TOTP, or Time-based One-time Password, is an algorithm used to generate the second password/factor, based on a secret key and the current time.
<br/><br/>
So, in simple terms:
```txt
TOTP = secret_key + current_time

or

totp(secret_key, current_time)
```
But in practice, there are more variables that you can control, so you can read here about the: [TOTP](https://en.wikipedia.org/wiki/Time-based_One-Time_Password). Or here about a [C client](https://www.nongnu.org/oath-toolkit/reference/liboath-oath.h.html#oath-totp-validate2).
<br/><br/>
Both the authenticator and the authenticatee compute the TOTP value, then the authenticator checks whether the TOTP value supplied by the authenticatee matches the locally generated TOTP value. Some authenticators allow values that should have been generated before or after the current time in order to account for slight clock skews, network latency and user delays.
<br/><br/>
The secret key can be any base32 string (spaces are ignored). So, in order to generate a TOTP(Time-based One-Time Password) for any given secret key, you can use the `oathtool` command (install using `apt install oathtool`):
```bash
paul@server:/$ oathtool --totp=SHA1 --verbose --base32 "ABCD 2345 EFGH 6723 IJKL 4567 MNOP 2345"
Hex secret: 00443d6f9d214c7f7f5b4254be77df635cfd6f9d
Base32 secret: ABCD2345EFGH6723IJKL4567MNOP2345
Digits: 6
Window size: 0
TOTP mode: SHA1
Step size (seconds): 30
Start time: 1970-01-01 00:00:00 UTC (0)
Current time: 2021-07-07 08:30:27 UTC (1625646627)
Counter: 0x33AD8BC (54188220)

003916

# Or just run:
paul@server:/$ oathtool --totp=SHA1 --base32 "ABCD 2345 EFGH 6723 IJKL 4567 MNOP 2345"
003916

# Or you can even control the variables: start_time(T0 - default 0 - unix epoch), time_interval(Tx - default: 30s), current_time(T - default: now), digits(default: 6):
paul@server:/$ oathtool --totp=SHA1 --start-time="1998-10-15 12:34:56 UTC" --time-step-size=10s --now="2021-07-07 08:41:25 UTC" --digits=8 --base32 "ABCD 2345 EFGH 6723 IJKL 4567 MNOP 2345" --verbose
Hex secret: 00443d6f9d214c7f7f5b4254be77df635cfd6f9d
Base32 secret: ABCD2345EFGH6723IJKL4567MNOP2345
Digits: 8
Window size: 0
TOTP mode: SHA1
Step size (seconds): 10
Start time: 1998-10-15 12:34:56 UTC (908454896)
Current time: 2021-07-07 08:41:25 UTC (1625647285)
Counter: 0x4465946 (71719238)

83402138
```
<br/>

---

<br/>
If you want to generate a QR code for a secret key, you can use the `qrencode` (install using `apt install qrencode`) command:
```bash
# Generate a .svg file with the QR code 
paul@server:/$ qrencode -t svg -o- "otpauth://totp/my_identification?secret=ABCD2345EFGH6723IJKL4567MNOP2345&issuer=my_company&algorithm=SHA1&digits=6&period=30"

# Generate a .png file with the QR code 
paul@server:/$ qrencode -t png -o/data/qr.png "otpauth://totp/my_identification?secret=ABCD2345EFGH6723IJKL4567MNOP2345&issuer=my_company&algorithm=SHA1&digits=6&period=30"

# Generate and display(show) the QR code
paul@server:/$ qrencode -t svg -o- "otpauth://totp/my_identification?secret=ABCD2345EFGH6723IJKL4567MNOP2345&issuer=my_company&algorithm=SHA1&digits=6&period=30" | display
```
Here is a .svg QR code generated:
<svg width="5.19cm" height="5.19cm" viewBox="0 0 49 49" preserveAspectRatio="none" version="1.1" xmlns="http://www.w3.org/2000/svg">
	<g id="QRcode">
		<rect x="0" y="0" width="49" height="49" fill="#ffffff"/>
		<path style="stroke:#000000" transform="translate(4,4.5)" d="M0,0h1M1,0h1M2,0h1M3,0h1M4,0h1M5,0h1M6,0h1M8,0h1M10,0h1M12,0h1M13,0h1M15,0h1M17,0h1M19,0h1M21,0h1M22,0h1M23,0h1M25,0h1M27,0h1M28,0h1M30,0h1M34,0h1M35,0h1M36,0h1M37,0h1M38,0h1M39,0h1M40,0h1M0,1h1M6,1h1M8,1h1M10,1h1M13,1h1M14,1h1M15,1h1M18,1h1M19,1h1M20,1h1M21,1h1M22,1h1M25,1h1M28,1h1M29,1h1M31,1h1M34,1h1M40,1h1M0,2h1M2,2h1M3,2h1M4,2h1M6,2h1M8,2h1M11,2h1M12,2h1M14,2h1M16,2h1M18,2h1M22,2h1M23,2h1M24,2h1M27,2h1M28,2h1M29,2h1M31,2h1M32,2h1M34,2h1M36,2h1M37,2h1M38,2h1M40,2h1M0,3h1M2,3h1M3,3h1M4,3h1M6,3h1M8,3h1M9,3h1M10,3h1M16,3h1M17,3h1M19,3h1M20,3h1M21,3h1M22,3h1M23,3h1M24,3h1M25,3h1M27,3h1M28,3h1M31,3h1M32,3h1M34,3h1M36,3h1M37,3h1M38,3h1M40,3h1M0,4h1M2,4h1M3,4h1M4,4h1M6,4h1M10,4h1M11,4h1M12,4h1M16,4h1M19,4h1M20,4h1M22,4h1M24,4h1M25,4h1M26,4h1M27,4h1M29,4h1M32,4h1M34,4h1M36,4h1M37,4h1M38,4h1M40,4h1M0,5h1M6,5h1M8,5h1M10,5h1M11,5h1M12,5h1M15,5h1M20,5h1M22,5h1M23,5h1M25,5h1M27,5h1M28,5h1M30,5h1M32,5h1M34,5h1M40,5h1M0,6h1M1,6h1M2,6h1M3,6h1M4,6h1M5,6h1M6,6h1M8,6h1M10,6h1M12,6h1M14,6h1M16,6h1M18,6h1M20,6h1M22,6h1M24,6h1M26,6h1M28,6h1M30,6h1M32,6h1M34,6h1M35,6h1M36,6h1M37,6h1M38,6h1M39,6h1M40,6h1M10,7h1M14,7h1M18,7h1M19,7h1M20,7h1M21,7h1M22,7h1M23,7h1M27,7h1M28,7h1M29,7h1M30,7h1M0,8h1M1,8h1M4,8h1M5,8h1M6,8h1M10,8h1M11,8h1M12,8h1M13,8h1M15,8h1M20,8h1M21,8h1M23,8h1M24,8h1M27,8h1M29,8h1M31,8h1M35,8h1M37,8h1M38,8h1M39,8h1M40,8h1M0,9h1M2,9h1M4,9h1M9,9h1M12,9h1M17,9h1M18,9h1M20,9h1M21,9h1M22,9h1M23,9h1M25,9h1M26,9h1M27,9h1M28,9h1M30,9h1M31,9h1M33,9h1M34,9h1M35,9h1M36,9h1M37,9h1M38,9h1M39,9h1M40,9h1M0,10h1M2,10h1M3,10h1M6,10h1M10,10h1M12,10h1M13,10h1M14,10h1M16,10h1M17,10h1M19,10h1M22,10h1M23,10h1M27,10h1M32,10h1M34,10h1M36,10h1M39,10h1M0,11h1M1,11h1M2,11h1M5,11h1M7,11h1M13,11h1M15,11h1M17,11h1M20,11h1M21,11h1M25,11h1M28,11h1M30,11h1M36,11h1M37,11h1M39,11h1M2,12h1M4,12h1M6,12h1M9,12h1M10,12h1M13,12h1M16,12h1M18,12h1M25,12h1M26,12h1M29,12h1M30,12h1M34,12h1M35,12h1M37,12h1M40,12h1M5,13h1M8,13h1M10,13h1M12,13h1M14,13h1M18,13h1M19,13h1M20,13h1M21,13h1M22,13h1M23,13h1M24,13h1M27,13h1M32,13h1M33,13h1M34,13h1M37,13h1M38,13h1M39,13h1M40,13h1M5,14h1M6,14h1M9,14h1M10,14h1M11,14h1M12,14h1M15,14h1M21,14h1M23,14h1M28,14h1M29,14h1M30,14h1M32,14h1M34,14h1M38,14h1M40,14h1M0,15h1M2,15h1M4,15h1M9,15h1M10,15h1M11,15h1M13,15h1M15,15h1M16,15h1M17,15h1M19,15h1M21,15h1M26,15h1M29,15h1M31,15h1M33,15h1M34,15h1M35,15h1M38,15h1M39,15h1M40,15h1M0,16h1M4,16h1M6,16h1M8,16h1M9,16h1M10,16h1M14,16h1M19,16h1M21,16h1M23,16h1M27,16h1M29,16h1M31,16h1M33,16h1M39,16h1M0,17h1M2,17h1M4,17h1M5,17h1M8,17h1M9,17h1M10,17h1M11,17h1M12,17h1M13,17h1M14,17h1M15,17h1M16,17h1M18,17h1M19,17h1M23,17h1M26,17h1M27,17h1M28,17h1M30,17h1M34,17h1M36,17h1M37,17h1M38,17h1M39,17h1M40,17h1M0,18h1M1,18h1M2,18h1M4,18h1M5,18h1M6,18h1M11,18h1M12,18h1M16,18h1M17,18h1M22,18h1M23,18h1M24,18h1M27,18h1M30,18h1M32,18h1M34,18h1M36,18h1M37,18h1M39,18h1M0,19h1M1,19h1M2,19h1M4,19h1M7,19h1M9,19h1M14,19h1M16,19h1M17,19h1M20,19h1M21,19h1M25,19h1M27,19h1M28,19h1M30,19h1M32,19h1M33,19h1M36,19h1M37,19h1M40,19h1M0,20h1M2,20h1M6,20h1M7,20h1M8,20h1M9,20h1M10,20h1M12,20h1M13,20h1M14,20h1M18,20h1M19,20h1M21,20h1M25,20h1M26,20h1M27,20h1M28,20h1M29,20h1M30,20h1M34,20h1M35,20h1M40,20h1M0,21h1M2,21h1M4,21h1M8,21h1M9,21h1M10,21h1M13,21h1M16,21h1M18,21h1M20,21h1M22,21h1M23,21h1M24,21h1M31,21h1M32,21h1M33,21h1M34,21h1M37,21h1M39,21h1M40,21h1M0,22h1M2,22h1M3,22h1M6,22h1M9,22h1M10,22h1M13,22h1M16,22h1M17,22h1M18,22h1M19,22h1M20,22h1M21,22h1M22,22h1M25,22h1M26,22h1M28,22h1M29,22h1M30,22h1M31,22h1M36,22h1M37,22h1M40,22h1M0,23h1M2,23h1M3,23h1M4,23h1M5,23h1M7,23h1M9,23h1M10,23h1M12,23h1M17,23h1M18,23h1M19,23h1M20,23h1M21,23h1M23,23h1M24,23h1M26,23h1M29,23h1M30,23h1M32,23h1M36,23h1M0,24h1M3,24h1M6,24h1M9,24h1M10,24h1M11,24h1M13,24h1M14,24h1M15,24h1M19,24h1M24,24h1M29,24h1M32,24h1M33,24h1M38,24h1M39,24h1M40,24h1M1,25h1M3,25h1M4,25h1M9,25h1M12,25h1M15,25h1M17,25h1M18,25h1M21,25h1M23,25h1M25,25h1M26,25h1M27,25h1M28,25h1M29,25h1M30,25h1M33,25h1M34,25h1M36,25h1M38,25h1M39,25h1M40,25h1M3,26h1M4,26h1M6,26h1M9,26h1M10,26h1M11,26h1M13,26h1M14,26h1M15,26h1M18,26h1M20,26h1M21,26h1M22,26h1M23,26h1M24,26h1M25,26h1M27,26h1M28,26h1M29,26h1M32,26h1M33,26h1M35,26h1M36,26h1M37,26h1M39,26h1M2,27h1M4,27h1M5,27h1M7,27h1M8,27h1M9,27h1M13,27h1M16,27h1M21,27h1M22,27h1M23,27h1M24,27h1M26,27h1M29,27h1M30,27h1M31,27h1M32,27h1M33,27h1M34,27h1M35,27h1M36,27h1M37,27h1M40,27h1M0,28h1M2,28h1M3,28h1M6,28h1M8,28h1M10,28h1M11,28h1M13,28h1M16,28h1M19,28h1M21,28h1M26,28h1M28,28h1M29,28h1M30,28h1M40,28h1M0,29h1M1,29h1M2,29h1M3,29h1M4,29h1M8,29h1M9,29h1M10,29h1M12,29h1M13,29h1M14,29h1M18,29h1M20,29h1M22,29h1M23,29h1M24,29h1M27,29h1M29,29h1M32,29h1M33,29h1M34,29h1M40,29h1M3,30h1M5,30h1M6,30h1M8,30h1M11,30h1M12,30h1M13,30h1M14,30h1M15,30h1M19,30h1M21,30h1M22,30h1M24,30h1M25,30h1M26,30h1M27,30h1M28,30h1M30,30h1M32,30h1M34,30h1M35,30h1M38,30h1M40,30h1M2,31h1M3,31h1M4,31h1M9,31h1M10,31h1M11,31h1M14,31h1M15,31h1M16,31h1M20,31h1M27,31h1M29,31h1M31,31h1M32,31h1M33,31h1M34,31h1M36,31h1M38,31h1M39,31h1M40,31h1M0,32h1M1,32h1M4,32h1M5,32h1M6,32h1M8,32h1M10,32h1M13,32h1M16,32h1M17,32h1M19,32h1M20,32h1M22,32h1M24,32h1M26,32h1M29,32h1M31,32h1M32,32h1M33,32h1M34,32h1M35,32h1M36,32h1M40,32h1M8,33h1M9,33h1M10,33h1M12,33h1M13,33h1M14,33h1M15,33h1M16,33h1M18,33h1M20,33h1M23,33h1M25,33h1M27,33h1M28,33h1M31,33h1M32,33h1M36,33h1M38,33h1M39,33h1M40,33h1M0,34h1M1,34h1M2,34h1M3,34h1M4,34h1M5,34h1M6,34h1M9,34h1M10,34h1M11,34h1M15,34h1M17,34h1M20,34h1M22,34h1M23,34h1M24,34h1M25,34h1M27,34h1M29,34h1M30,34h1M31,34h1M32,34h1M34,34h1M36,34h1M39,34h1M0,35h1M6,35h1M8,35h1M9,35h1M14,35h1M15,35h1M17,35h1M18,35h1M20,35h1M22,35h1M27,35h1M28,35h1M32,35h1M36,35h1M37,35h1M39,35h1M40,35h1M0,36h1M2,36h1M3,36h1M4,36h1M6,36h1M8,36h1M10,36h1M11,36h1M12,36h1M13,36h1M14,36h1M15,36h1M18,36h1M19,36h1M21,36h1M26,36h1M27,36h1M28,36h1M29,36h1M30,36h1M31,36h1M32,36h1M33,36h1M34,36h1M35,36h1M36,36h1M37,36h1M39,36h1M0,37h1M2,37h1M3,37h1M4,37h1M6,37h1M10,37h1M13,37h1M16,37h1M17,37h1M20,37h1M21,37h1M22,37h1M23,37h1M24,37h1M27,37h1M31,37h1M32,37h1M33,37h1M35,37h1M38,37h1M40,37h1M0,38h1M2,38h1M3,38h1M4,38h1M6,38h1M9,38h1M14,38h1M16,38h1M20,38h1M21,38h1M25,38h1M26,38h1M27,38h1M28,38h1M29,38h1M30,38h1M35,38h1M38,38h1M39,38h1M40,38h1M0,39h1M6,39h1M8,39h1M12,39h1M13,39h1M14,39h1M17,39h1M18,39h1M21,39h1M23,39h1M24,39h1M26,39h1M28,39h1M29,39h1M31,39h1M32,39h1M33,39h1M34,39h1M35,39h1M38,39h1M39,39h1M40,39h1M0,40h1M1,40h1M2,40h1M3,40h1M4,40h1M5,40h1M6,40h1M8,40h1M11,40h1M12,40h1M13,40h1M15,40h1M16,40h1M17,40h1M18,40h1M20,40h1M22,40h1M27,40h1M29,40h1M31,40h1M39,40h1"/>
	</g>
</svg>
If you load this 2FA secret key in a 2FA app, Google Authenticator for example, it will show up like:
```txt
my_company (my_identification)
402 468
```
<br/>

---

<br/>
If you want to read the contents of a QR code, you can use the `zbarimg` (install using `apt-get install zbar-tools`) command:
```bash
paul@server:/$ zbarimg --raw /data/qr.svg --quiet
otpauth://totp/my_identification?secret=ABCD2345EFGH6723IJKL4567MNOP2345&issuer=my_company&algorithm=SHA1&digits=6&period=30
paul@server:/$ zbarimg --raw /data/qr.png --quiet
otpauth://totp/my_identification?secret=ABCD2345EFGH6723IJKL4567MNOP2345&issuer=my_company&algorithm=SHA1&digits=6&period=30
```
